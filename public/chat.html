<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Terminal Chat</title>
    <link rel="stylesheet" href="https://unpkg.com/xterm/css/xterm.css" />
    <script src="https://unpkg.com/xterm/lib/xterm.js"></script>
    <style>
        html, body {
            height: 100%;
            margin: 0;
        }
        #terminal {
            width: 100vw;
            height: 100vh;
        }
    </style>
</head>
<body>
    <div id="terminal"></div>
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const terminal = new Terminal();
            function resizeTerminal() {
                terminal.fit();
            }
            terminal.open(document.getElementById('terminal'));
            window.addEventListener('resize', resizeTerminal);
            resizeTerminal();
            const protocol = (window.location.protocol === 'https:') ? 'wss://' : 'ws://';
            const wsUrl = protocol + window.location.host;
            const ws = new WebSocket(wsUrl);

            ws.onopen = () => {
                console.log('WebSocket connection established');
            };

            ws.onmessage = event => {
                terminal.write(event.data);
            };

            terminal.onData(data => {
                ws.send(data);
            });

            ws.onclose = () => {
                console.log('WebSocket connection closed');
                terminal.write('\r\nConnection closed, please reload the page to reconnect.\r\n');
            };

            ws.onerror = error => {
                console.error('WebSocket error:', error);
                terminal.write('\r\nConnection error, please check the console for more information.\r\n');
            };
        });
    </script>
</body>
</html>